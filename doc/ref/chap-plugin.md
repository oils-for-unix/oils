---
title: Plugins and Hooks (Oils Reference)
all_docs_url: ..
body_css_class: width40
default_highlighter: oils-sh
preserve_anchor_case: yes
---

<div class="doc-ref-header">

[Oils Reference](index.html) &mdash;
Chapter **Plugins and Hooks**

</div>

This chapter describes extension points for OSH and YSH.

<span class="in-progress">(in progress)</span>

<div id="dense-toc">
</div>

## Signals

### SIGTERM

SIGTERM is the default signal sent by `kill`.  It asks a process to terminate.

You can register a SIGTERM handler with the [trap][] builtin.

[trap]: chap-builtin-cmd.html#trap

### SIGINT

SIGINT is usually generated by Ctrl-C.  It interrupts what the shell is doing
and returns to the prompt.

You can register a SIGINT handler with the [trap][] builtin.

### SIGQUIT

SIGQUIT is usually generated by Ctrl-\.

### SIGTTIN

Used by the job control implementation.

### SIGTTOU

Used by the job control implementation.

### SIGWINCH

Oils receives this signal when the terminal window size changes.

## Traps

### DEBUG

Runs code before "leaf" commands, like

    echo hi
    a=b
    [[ x -eq y ]]
    (( a = 42 ))

But not before `{`:

    { echo one; echo two; }

---

See the [Quirks doc](../quirks.html) for an interaction between the `DEBUG`
trap, pipelines, and interactive shells.

### ERR

The `ERR` trap runs when a command fails, i.e. in the situations where `set -o
errexit` aka `set -e` exits the shell.

To enable it in functions and subshells, use `set -o errtrace`, aka `set -E`.

It's designed to be compatible with bash.

### EXIT

TODO

### RETURN

TODO

## Words

### PS1

The `PS1` variable controls the first line of the shell prompt.  It is designed
to be bash-compatible.

See the [Bash Manual > Controlling the Prompt][bash-prompt].

[bash-prompt]: https://www.gnu.org/software/bash/manual/html_node/Controlling-the-Prompt.html

Note that the general `\D{format}` is implemented, but some of the more
specific time formats are not implemented.

### PS2

Second line of the shell prompt (unimplemented).

### PS3

For the `select` builtin (unimplemented).

### PS4

The prefix of each line of output in `set -x` aka `set -o xtrace`.  The leading
character is special.

## Completion

### complete

The [complete][] builtin calls back into the shell evaluator to create
candidate strings for autocompletion:

- `-C` is an external command that's executed
- `-F` is the name of a shell function name that's run
- `-W` is a word list that's evalutaed

[complete]: chap-builtin-cmd.html#complete

## Other Plugin

### PROMPT_COMMAND

A command that's executed before each prompt.

This feature is taken from [bash]($xref).

## YSH

### renderPrompt()

Users may define this func to customize their prompt.

The func should take the global `value.IO` instance, and return a prompt string
(type `value.Str`).

To construct the prompt, it can make calls like
[`io->promptVal('$')`]($chap-type-method:promptVal).

To render the prompt, YSH first checks if this function exists.  Otherwise, it
uses [`$PS1`]($chap-plugin:PS1) with a `ysh` prefix.

<!-- note: doctools/cmark.py turns promptVal -> promptval -->

